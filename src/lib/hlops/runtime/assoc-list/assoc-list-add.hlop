(* assoc-list-add.hlop
 *
 * COPYRIGHT (c) 2007 The Manticore Project (http://manticore.cs.uchicago.edu)
 * All rights reserved.
 *
 * Add an element to the association list.
 *
 *)

#include "types.def"

define @assoc-list-add (atag : assoc_tag, elt : any, alist : ![assoc_list] / exh : exh) : () =
  let l : assoc_list = #0(alist)
  let l' : assoc_list = ACONS (atag, elt, l)
  let l' : assoc_list = promote (l')
  do #0(alist) := l'
  return ()
;
